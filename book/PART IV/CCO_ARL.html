<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>cco_arl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="CCO_ARL_files/libs/clipboard/clipboard.min.js"></script>
<script src="CCO_ARL_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="CCO_ARL_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="CCO_ARL_files/libs/quarto-html/popper.min.js"></script>
<script src="CCO_ARL_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="CCO_ARL_files/libs/quarto-html/anchor.min.js"></script>
<link href="CCO_ARL_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="CCO_ARL_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="CCO_ARL_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="CCO_ARL_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="CCO_ARL_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<pre><code>
## Limites de Operação e Plano Amostral

Especificar o plano amostral, a frequência de coleta e os limites de controle de um processo são algumas das decisões críticas na construção de gráficos de controle. Na inviabilidade de inspecionar todos os itens produzidos, são selecionados uma certa quantidade por lote de forma aleatória para composição das amostras. Naturalmente, quanto mais itens amostrados, maior a aproximação da representação real do processo e consequente maior controle. Logo, as alternativas viáveis são, ou tomar amostras pequenas com maior frequência, ou amostras grandes com menor frequência [@Carpinetti2003; @Montgomery2012Statistical]. 

A depender do número defeitos presentes, o lote pode ser aceito ou rejeitado, parelho ao teste de hipóteses:

$$
\left\{ \begin{array} HH_0: p = p_0\\ H_1: p \neq p_0 \end{array} \right.
$$

onde $p$ representa a proporção de defeitos na produção [@Botter2013].

Quando estabelecemos limites de controle afastados da linha central, aumentamos a tolerância do processo, diminuindo assim o risco de ocorrer pontos fora dos limites. Esse risco é denominado erro tipo I ($\alpha$) ou *risco do produtor*, responsável por indicar condições fora do controle sem causa atribuível (*alarme falso*).

A presença de baixos valores para o erro tipo I dificulta a detecção de defeitos reais, implicando no aumento de itens dentro dos limites de controle, quando o processo na realidade estiver fora de controle. A esse risco denominamos erro do tipo II ($\beta$) ou *risco do consumidor*. 

No caso de aproximação dos limites de controle da linha central gera o efeito contrário; quando o risco do produtor aumenta, o do consumidor diminui [@Montgomery2012Statistical; @Botter2013]. O cenário desejável é a identificação eficiente desses defeitos antes que ele seja repassado ao consumidor, garantindo a qualidade do produto.

Para um processo controlado sob condição de normalidade -- $X_{i} \sim N(\mu, \sigma^2)$ -- em um nível de operação ($L$) temos que a probabilidade do processo estar sob controle é dada por 

$$ 
P\left[LIC \leq \bar{X}_i \leq LSC \right] \Rightarrow P\left[\dfrac{\mu -L\sigma}{\sqrt{n}} \leq \bar{X}_i \leq \dfrac{\mu + L\sigma}{\sqrt{n}}\right],
$$
onde $LIC$ representa o limite inferior de controle e $LSC$, o limite superior de controle, $\sigma$ o desvio-padrão da operação e $n$, o número de amostras. \
\
Para um processo operado em $3\sigma$ ($L=3$), temos que
$$\therefore P\left[ \dfrac{\mu -3\sigma}{\sqrt{n}} \leq \bar{X}_i \leq \dfrac{\mu + 3\sigma}{\sqrt{n}}\right] = 0.9973.
$$

 Pela normalização dos dados -- $X_{i} \sim N(0, 1)$--, o erro tipo II corresponde a 99,73% e o erro tipo I a 0,27%. Em outras palavras, o processo acusará 27 alarmes falsos em 10.000 itens produzidos.\
\

## Curva Característica de Operação (CCO $\cdot \bar{X}$)

A capacidade dos gráficos $\bar{X}$ e $R$ de detectar mudanças no processo é descrita pelas chamadas Curvas Características de Operação (CCO), utilizadas na fase II de monitoramento de um processo. Considerando que a variabilidade do processo se mantém constante ao longo do tempo, $\beta$, nesse caso, representa a probabilidade de *não* serem detectadas mudanças na média na amostra subsequente [@Montgomery2012Statistical].\
\
Em termos probabilísticos, o risco do consumidor ($\beta$) para uma dada média em um nível $\mu_0$ mudar para $\mu_1$, sendo $\mu_1 = \mu_0 + k\sigma$, pode descrito ser como

$$
\beta = P \left[ LIC \leq \bar{X} \leq LSC | \mu = \mu_1 = \mu_0 + k\sigma \right],
$$

onde $k$ representa o número de desvios ($\sigma$) em relação à média ($\mu_0$).\
\
Levando em conta a média amostral com distribuição normal $\bar{x} \sim N(\mu, \sigma^2/n)$ e limites superior e inferior de controle $LSE = \mu_0 + L\sigma/\sqrt{n}$ e $LIE = \mu_0 - L\sigma/\sqrt{n}$, os termos podem ser trabalhados em termos de função de distribuição cumulativa normal $\Phi(\cdot)$. Desta forma, a função $\beta$ pode ser expressa como

$$ \beta = \Phi \left[\dfrac{LSE - \mu_1}{\sigma \sqrt{n}}\right] - \Phi \left[\dfrac{LIE + \mu_1}{\sigma \sqrt{n}}\right]. 
$$

A partir das definições, podemos realizar as substituições dos limites de controle amostrais e da nova média $\mu_1$, resultando em

$$ 
\beta = \Phi \left[\dfrac{(\mu_0 + L\sigma/\sqrt{n}) - (\mu_0 + k\sigma)}{\sigma \sqrt{n}}\right] - \Phi \left[\dfrac{(\mu_0 - L\sigma/\sqrt{n}) + (\mu_0 + k\sigma)}{\sigma \sqrt{n}}\right].
$$

Fazendo os devidos ajustes de cálculo, a equação acima pode ser simplificada para

$$
\beta = \Phi \left[L - k\sqrt{n}\right] - \Phi \left[-L - k\sqrt{n}\right].
$$

Para ilustrar sua aplicação, tomemos um processo que opera em $3\sigma$, coletando cinco amostras por inspeção ($n=5$). Para determinar a probabilidade de deteção de mudança na média em dois desvios-padrão ($k=2$) na primeira amostra após o deslocamento para $\mu_1 = \mu_0 + 2\sigma$, incialmente calculamos a probaibilidade de *não-detecção* ($\beta$): 

::: {.panel-tabset}
### R

```{.r .cell-code}
L = 3 ; k = 2
beta = pnorm(L - k*sqrt(5)) - pnorm(-L - k*sqrt(5))
round(beta, 4)</code></pre>
<p>[1] 0.0705 ### Python</p>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="dv">3</span> <span class="op">;</span> k <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> norm.cdf(L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">5</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">5</span>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">round</span>(beta, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>0.0705 :::</p>
<p>Logo, a probabilidade de decteção do deslocamento é <span class="math inline">\(1-\beta = 1 - 0,0705 = 0,9295\)</span> ou 92,95%. De forma progressiva, podemos construir as CCOs para gráfico de médias (<span class="math inline">\(\bar{X}\)</span>) para diferentes números de amostra. A definição dos pontos da curva depende do cruzamento entre o valor do risco <span class="math inline">\(\beta\)</span> em relação a extensão do deslocamento (<span class="math inline">\(k\)</span>) para um número de amostras (<span class="math inline">\(n\)</span>).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> <span class="dv">3</span>                             <span class="co"># Nível do processo </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)   <span class="co"># Valores para deslocamento</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidade de detecção de mudanças (erro tipo II)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">=</span> <span class="fu">pnorm</span>(L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span>))     <span class="co"># para n = 1</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>beta_2 <span class="ot">=</span> <span class="fu">pnorm</span>(L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span>))     <span class="co"># para n = 2</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>beta_5 <span class="ot">=</span> <span class="fu">pnorm</span>(L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">5</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">5</span>))     <span class="co"># para n = 5</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>beta_10 <span class="ot">=</span> <span class="fu">pnorm</span>(L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">10</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">10</span>))  <span class="co"># para n = 10</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>beta_20 <span class="ot">=</span> <span class="fu">pnorm</span>(L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">20</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">20</span>))  <span class="co"># para n = 20</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico comparativo das Curvas</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(1, 1))</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k, beta_1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">2</span>, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k, beta_2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">2</span>, </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span>,<span class="fu">pnorm</span>(L <span class="sc">-</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span>)), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">1.25</span>) </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k, beta_5, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">2</span>, </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k, beta_10, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">2</span>, </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k, beta_20, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">2</span>, </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">axes=</span>T,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Deslocamento da Média (k)"</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Risco do Consumidor (β)"</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Curva Característica de Operação -- Gráfico X-bar"</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span>,<span class="fu">pnorm</span>(L <span class="sc">-</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">20</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">20</span>)), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">1.25</span>) </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">title=</span><span class="st">"Amostras"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"n = 1"</span>, <span class="st">"n = 2"</span>, <span class="st">"n = 5"</span>, <span class="st">"n = 10"</span>, <span class="st">"n = 20"</span>),  </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="CCO_ARL_files/figure-html/ccor-1.png" class="img-fluid" width="672"> ### Python</p>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="dv">3</span>                       <span class="co"># Nível do processo </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">100</span>)  <span class="co"># Valores para deslocamento</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidade de detecção de mudanças (erro tipo II)</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="op">=</span> norm.cdf(L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">1</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">1</span>))    <span class="co"># para n = 1</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>beta_2 <span class="op">=</span> norm.cdf(L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">2</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">2</span>))    <span class="co"># para n = 2</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>beta_5 <span class="op">=</span> norm.cdf(L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">5</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">5</span>))    <span class="co"># para n = 5</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>beta_10 <span class="op">=</span> norm.cdf(L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">10</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">10</span>)) <span class="co"># para n = 10</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>beta_20 <span class="op">=</span> norm.cdf(L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">20</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">20</span>)) <span class="co"># para n = 20</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico comparativo das Curvas</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>plt.plot(k, beta_1, linestyle <span class="op">=</span> <span class="st">'--'</span>, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"black"</span>, label <span class="op">=</span> <span class="st">'n = 1'</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>plt.plot(k, beta_2, linestyle <span class="op">=</span> <span class="st">'--'</span>, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"red"</span>, label <span class="op">=</span> <span class="st">'n = 2'</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="dv">1</span>, norm.cdf(L <span class="op">-</span> <span class="dv">1</span><span class="op">*</span>np.sqrt(<span class="dv">2</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">*</span>np.sqrt(<span class="dv">2</span>)), <span class="st">'ro'</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>plt.plot(k, beta_5, linestyle <span class="op">=</span> <span class="st">'--'</span>, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"green"</span>, label <span class="op">=</span> <span class="st">'n = 5'</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>plt.plot(k, beta_10, linestyle <span class="op">=</span> <span class="st">'--'</span>, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"blue"</span>, label <span class="op">=</span> <span class="st">'n = 10'</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>plt.plot(k, beta_20, linestyle <span class="op">=</span> <span class="st">'--'</span>, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"purple"</span>, label <span class="op">=</span> <span class="st">'n = 20'</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="dv">1</span>, norm.cdf(L <span class="op">-</span> <span class="dv">1</span><span class="op">*</span>np.sqrt(<span class="dv">20</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">*</span>np.sqrt(<span class="dv">20</span>)), <span class="st">'ro'</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Deslocamento da Média (k)'</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Risco do Consumidor (β)'</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Curva Característica de Operação -- Gráfico X-bar'</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(0.0, 1.0)</p>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Amostras'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">.3</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="CCO_ARL_files/figure-html/ccopy-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<p>É notável que um número pequeno de amostras implica em um baixo poder de detecção. Por exemplo, em um caso de inspeção com duas amostras (<span class="math inline">\(n=2\)</span>, destacado no gráfico no ponto vermelho mais acima), a probabilidade de identificação de uma mudança em um desvio-padrão (<span class="math inline">\(k=1\)</span>) na amostra subsequente é de apenas 5,64% (<span class="math inline">\(\beta=0.9436 \therefore 1-\beta=0.0564\)</span>). Já com <span class="math inline">\(n=20\)</span> (ponto vermelho mais abaixo), a detecção efetiva nas mesmas condições é de 92,95% na primeira amostra após a mudança na média (<span class="math inline">\(\beta=0.0705 \therefore 1-\beta=0.9295\)</span>). Isso demonstra o comportamento natural de melhoria na detecção de defeitos conforme o número de amostras é ampliado.</p>
<section id="comprimento-médio-de-sequência-arl" class="level2">
<h2 class="anchored" data-anchor-id="comprimento-médio-de-sequência-arl">Comprimento Médio de Sequência (ARL)</h2>
<p>Outra análise possível é a definição da probabilidade de identificar o deslocamento a cada nova amostra. Utilizando o exemplo já mencionado (<span class="math inline">\(L=3\)</span>, <span class="math inline">\(n=2\)</span>, <span class="math inline">\(k=1\)</span> e <span class="math inline">\(\beta = 0.9436\)</span>), a detecção de mudanças na segunda amostra é dado por <span class="math inline">\(\beta(1-\beta)\)</span>, isto é, a oscilação não foi apontada na primeira amostra (risco <span class="math inline">\(\beta\)</span>), ocorrendo na segunda amostra (<span class="math inline">\(1-\beta\)</span>). Desta forma, <span class="math inline">\(0.9436^1(1-0.9436) = 0.0532\)</span>, resultando em uma probabilidade de 5,32%. Na terceira, a probabilidade é dada por <span class="math inline">\(\beta^2(1-\beta)\)</span>, isto é, <span class="math inline">\(0.9436^2(1-0.9436) = 0.0502\)</span> ou 5,02%. Seguindo progressivamente a mesma lógica, a probabilidade de captar a oscilação da média na <span class="math inline">\(r\)</span>-ésima amostra pode ser generalizada por</p>
<p><span class="math display">\[
\beta^{r-1}(1-\beta).
\]</span></p>
<p>Buscando conhecer número médio de amostras coletadas até que um sinal seja emitido pelo gráfico de controle <span class="math inline">\(\bar{X}\)</span>, podemos descrever o quantitativo por meio de um somatório de <span class="math inline">\(\beta\)</span>, de tal forma que</p>
<p><span class="math display">\[
\sum_{i=1}^\infty \beta^{r=1}(1-\beta) = \dfrac{1}{1-\beta} = ARL.
\]</span></p>
<p>Essa medida é denominada <em>Comprimento Médio de Sequência</em> (ARL<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>), sendo utilizada para subsidiar decisões relativas ao tamanho da amostra e à frequência de amostragem. Na prática, indica quantos pontos de um processo consegue registrar antes que o gráfico aponte uma possível alteração ou desvio, seja ele dentro de controle (<span class="math inline">\(ARL_0\)</span>) ou fora de controle (<span class="math inline">\(ARL_1\)</span>).</p>
<p>Tomando como cenário um processo em <span class="math inline">\(3\sigma\)</span> sob controle, o risco de pontos fora de controle (erro tipo I) é de <span class="math inline">\(0.0027\)</span>. Logo, podemos calcular</p>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ARL_0 <span class="ot">=</span>  <span class="dv">1</span> <span class="sc">/</span> <span class="fl">0.0027</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ARL_0, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>[1] 370.37</p>
<p>significando dizer que o processo acusará um alarme falso, em média, a cada 370 amostras. Em um caso alternativo, onde um processo com <span class="math inline">\(n=5\)</span> amostras coletadas tenha sofrido alguma alteração em sua média, o <span class="math inline">\(ARL_1\)</span> é dado por <span class="math display">\[
ARL_1 = \dfrac{1}{1-\beta} = \dfrac{1}{1 - \left\{ \Phi \left[L - k\sqrt{n}\right] - \Phi \left[-L - k\sqrt{n}\right] \right\}}.
\]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>arl_1 <span class="ot">=</span>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">3</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">5</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">3</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">5</span>)))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(arl_1, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>[1] 4.5 ### Python</p>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>arl_1 <span class="op">=</span>  <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> norm.cdf(<span class="dv">3</span> <span class="op">-</span> <span class="dv">1</span><span class="op">*</span>np.sqrt(<span class="dv">5</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span><span class="dv">3</span> <span class="op">-</span> <span class="dv">1</span><span class="op">*</span>np.sqrt(<span class="dv">5</span>)))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">round</span>(arl_1, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>4.5</p>
</div>
</div>
</div>
<p>Portanto, são necessárias aproximadamente cinco amostras coletadas para detecção de uma mudança de <span class="math inline">\(1\sigma\)</span> (<span class="math inline">\(k=1\)</span>).</p>
<p>Para a construção do gráfico de ARL considerando diferentes tamanhos de amostra (<span class="math inline">\(n\)</span>) e de deslocamentos da média (<span class="math inline">\(k\)</span>), temos que considerar o caso de ocorrência de pontos fora de controle (<span class="math inline">\(ARL_1\)</span>).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> <span class="dv">3</span>                             <span class="co"># Nível do processo </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)   <span class="co"># Valores para deslocamento</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprimento Médio de Sequência</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>ARL1 <span class="ot">=</span>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> (<span class="fu">pnorm</span>(L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span>))))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>ARL2 <span class="ot">=</span>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> (<span class="fu">pnorm</span>(L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span>))))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>ARL5 <span class="ot">=</span>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> (<span class="fu">pnorm</span>(L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">5</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">5</span>))))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>ARL10 <span class="ot">=</span>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> (<span class="fu">pnorm</span>(L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">10</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">10</span>))))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>ARL20 <span class="ot">=</span>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> (<span class="fu">pnorm</span>(L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">20</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L <span class="sc">-</span> k<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">20</span>))))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico comparativo das Curvas</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k, ARL1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k, ARL2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k, ARL5, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k, ARL10, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k, ARL20, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">axes=</span>T,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"Deslocamento da Média (k)"</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Comprimento Médio de Sequência (ARL)"</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Comprimento Médio de Sequência vs. Deslocamento da Média"</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">400</span>))</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">title=</span><span class="st">"Amostras"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"n = 1"</span>, <span class="st">"n = 2"</span>, <span class="st">"n = 5"</span>, <span class="st">"n = 10"</span>, <span class="st">"n = 20"</span>),  </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="CCO_ARL_files/figure-html/arl-r-1.png" class="img-fluid" width="672"> ### Python</p>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="dv">3</span>                       <span class="co"># Nível do processo </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">100</span>)  <span class="co"># Valores para deslocamento</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprimento Médio de Sequência</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>ARL1 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (norm.cdf(L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">1</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">1</span>))))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>ARL2 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (norm.cdf(L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">2</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">2</span>))))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>ARL5 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (norm.cdf(L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">5</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">5</span>))))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>ARL10 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (norm.cdf(L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">10</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">10</span>))))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>ARL20 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (norm.cdf(L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">20</span>)) <span class="op">-</span> norm.cdf(<span class="op">-</span>L <span class="op">-</span> k<span class="op">*</span>np.sqrt(<span class="dv">20</span>))))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico comparativo das Curvas</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>plt.plot(k, ARL1, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"black"</span>, label <span class="op">=</span> <span class="st">'n = 1'</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>plt.plot(k, ARL2, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"red"</span>, label <span class="op">=</span> <span class="st">'n = 2'</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>plt.plot(k, ARL5, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"green"</span>, label <span class="op">=</span> <span class="st">'n = 5'</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>plt.plot(k, ARL10, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"blue"</span>, label <span class="op">=</span> <span class="st">'n = 10'</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>plt.plot(k, ARL20, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"purple"</span>, label <span class="op">=</span> <span class="st">'n = 20'</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Deslocamento da Média (k)'</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Comprimento Médio de Sequência (ARL)'</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Comprimento Médio de Sequência vs. Deslocamento da Média'</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>,<span class="dv">400</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(0.0, 400.0)</p>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Amostras'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">.3</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="CCO_ARL_files/figure-html/arl-py-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
<section id="curva-característica-de-operação-cco-cdot-r" class="level2">
<h2 class="anchored" data-anchor-id="curva-característica-de-operação-cco-cdot-r">Curva Característica de Operação (CCO <span class="math inline">\(\cdot R\)</span>)</h2>
<p>Ao contrário da média, o gráfico de amplitude não apresenta uma distribuição simétrica, mesmo que a amostragem seja feita a partir de uma normalidade. Isso significa dizer que em um nível de operação de <span class="math inline">\(3\sigma\)</span> o risco <span class="math inline">\(\alpha\)</span> é diferente de <span class="math inline">\(0.0027\)</span>, resultante para a média.</p>
<p>Para a construção da CCO para o gráfico de amplitude, considera-se um intervalo relativo definido por <span class="math inline">\(W=R/\sigma\)</span>. Supondo que os valores dentro dos limites de controle tenham um desvio <span class="math inline">\(\sigma_0\)</span> e a oscilação do gráfico tenha resultado em um novo desvio <span class="math inline">\(\sigma_1\)</span>, o risco <span class="math inline">\(\beta\)</span> é dado em função da razão dos desvios ($_1 &gt; _0 _1 / _0 &gt; 1 $).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definição de valores para lambda (maiores que 1)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>lambdas <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="at">length.out =</span> <span class="dv">100</span>)  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidade de detecção de mudanças (erro tipo II)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>beta_2 <span class="ot">=</span> <span class="fu">beta_r</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">l_valores=</span>lambdas)    <span class="co"># para n = 2</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>beta_5 <span class="ot">=</span> <span class="fu">beta_r</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">l_valores=</span>lambdas)    <span class="co"># para n = 5</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>beta_10 <span class="ot">=</span> <span class="fu">beta_r</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">l_valores=</span>lambdas)  <span class="co"># para n = 10</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>beta_20 <span class="ot">=</span> <span class="fu">beta_r</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">l_valores=</span>lambdas)  <span class="co"># para n = 20</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico comparativo das Curvas</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(1, 1))</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lambdas, beta_2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">2</span>, </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lambdas, beta_5, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">2</span>, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lambdas, beta_10, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">2</span>, </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span> (<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lambdas, beta_20, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty=</span><span class="dv">2</span>, </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">axes=</span>T,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Razão dos desvios"</span>)),</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Risco do Consumidor (β)"</span>,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Curva Característica de Operação -- Gráfico R"</span>,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">title=</span><span class="st">"Amostras"</span>, <span class="at">lwd =</span> <span class="fl">1.25</span>, <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"n = 2"</span>, <span class="st">"n = 5"</span>, <span class="st">"n = 10"</span>, <span class="st">"n = 20"</span>),  </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="CCO_ARL_files/figure-html/ccor-r-1.png" class="img-fluid" width="672"> ### Python</p>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definição de valores para lambda (maiores que 1)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>lambdas <span class="op">=</span> np.linspace(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">100</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidade de detecção de mudanças (erro tipo II)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>beta_2 <span class="op">=</span> beta_py(n <span class="op">=</span> <span class="dv">2</span>, l_valores<span class="op">=</span>lambdas)    <span class="co"># para n = 2</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>beta_5 <span class="op">=</span> beta_py(n <span class="op">=</span> <span class="dv">5</span>, l_valores<span class="op">=</span>lambdas)    <span class="co"># para n = 5</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>beta_10 <span class="op">=</span> beta_py(n <span class="op">=</span> <span class="dv">10</span>, l_valores<span class="op">=</span>lambdas)  <span class="co"># para n = 10</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>beta_20 <span class="op">=</span> beta_py(n <span class="op">=</span> <span class="dv">20</span>, l_valores<span class="op">=</span>lambdas)  <span class="co"># para n = 20</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico comparativo das Curvas</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>plt.plot(lambdas, beta_2, linestyle <span class="op">=</span> <span class="st">'--'</span>, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"red"</span>, label <span class="op">=</span> <span class="st">'n = 2'</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>plt.plot(lambdas, beta_5, linestyle <span class="op">=</span> <span class="st">'--'</span>, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"green"</span>, label <span class="op">=</span> <span class="st">'n = 5'</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>plt.plot(lambdas, beta_10, linestyle <span class="op">=</span> <span class="st">'--'</span>, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"blue"</span>, label <span class="op">=</span> <span class="st">'n = 10'</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>plt.plot(lambdas, beta_20, linestyle <span class="op">=</span> <span class="st">'--'</span>, linewidth <span class="op">=</span> <span class="fl">.75</span>, color <span class="op">=</span> <span class="st">"purple"</span>, label <span class="op">=</span> <span class="st">'n = 20'</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="vs">r'Razão dos desvios </span><span class="kw">(</span><span class="dv">$</span><span class="er">\</span><span class="vs">lambda = </span><span class="dv">\s</span><span class="vs">igma_1 / </span><span class="dv">\s</span><span class="vs">igma_0</span><span class="dv">$</span><span class="kw">)</span><span class="vs">'</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Risco do Consumidor (β)'</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Curva Característica de Operação -- Gráfico R'</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>,<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(0.0, 6.0)</p>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(0.0, 1.0)</p>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Amostras'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">.3</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="CCO_ARL_files/figure-html/ccor-py-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<p>Nota-se que a CCO <span class="math inline">\(\cdot R\)</span> não demonstra bons resultados na detecção de mudanças para valores pequenos de amostra. Isso pode ser observado comparando os casos de <span class="math inline">\(n=2\)</span> e <span class="math inline">\(n=20\)</span>; se o desvio padrão do processo dobrar (isto é, <span class="math inline">\(\lambda = \sigma_1/\siga_0 = 2\)</span>), o primeiro caso tem cerca de 30% de chance em detectar a mudança na amostra subsequente; já no segundo caso, a chance alcança 90%. Por esse motivo, a literatura recomenda o uso do gráfico <span class="math inline">\(R\)</span> para subamostras racionais maiores que 10 <span class="citation" data-cites="Montgomery2012Statistical">[@Montgomery2012Statistical]</span>.</p>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>acrônimo em inglês para <em>Average Run Length</em><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>